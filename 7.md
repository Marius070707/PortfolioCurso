En esta práctica aprenderemos a utilizar la herramienta Wireshark para analizar 
el tráfico HTTP generado al navegar por una aplicación web vulnerable. 
El objetivo es comprender cómo viajan las peticiones y respuestas en 
una página web sin cifrado, identificar parámetros y cabeceras, analizar 
formularios y cookies de sesión, y entender los riesgos de seguridad asociados 
a este tipo de comunicaciones.

Utilizaremos la web http://testphp.vulnweb.com/

Filtramos únicamente peticiones de GET

  http.request.method == "GET"

Ahora filtramos con más cosas

  http.request.uri contains "="

Para analizar el login usamos el filtro POST

  http.request.method == "POST"

  Vamos a reflexionar sobre el riesgo de enviar credenciales por HTTP sin cifrar:

Enviar credenciales por HTTP sin cifrar es peligroso porque la información viaja 
en texto plano y puede ser vista fácilmente por cualquier persona que intercepte 
el tráfico de la red. Esto significa que un atacante podría obtener el usuario y
la contraseña sin mucha dificultad y acceder a la cuenta sin permiso. Por eso es 
importante usar HTTPS, ya que cifra los datos y protege la información personal 
durante la comunicación.

Para analizar recursos:

JPG:  http.request.uri contains ".jpg"
Scripts: http.request.uri contains ".js"
Hojas de estilo: http.request.uri contains ".css"

Para visualizar cookies usamos el filtro http.cookie

Y para encontrar errores http.response.code >= 400

--------------------------------CUESTIONARIO FOINAL-------------------------------------------

-----------------Lista todos los parámetros GET que aparecieron durante tu navegación.-----------------------

Durante la navegación se observaron varias peticiones GET con parámetros en la URL, como por ejemplo:

page=login
user=id
search=test
id=1
category=users

Estos parámetros viajaban visibles en la dirección web 

---------------¿Qué peticiones POST detectaste? ¿Qué información enviaron?-------------------

Se detectaron peticiones POST al enviar formularios, especialmente en el inicio de sesión.
Estas peticiones enviaban datos introducidos por el usuario, como:

nombre de usuario
contraseña
datos de formularios

La información se enviaba dentro del cuerpo de la petición HTTP.

------------------------¿Cómo viajan las credenciales del formulario de login?--------------------------------------

Las credenciales viajan en texto plano dentro de la petición POST por lo que 
pueden leerse fácilmente en Wireshark sin necesidad de descifrar nada. Esto
permite ver directamente el usuario y la contraseña enviados.

----------------------------¿Qué cookies o identificadores de sesión aparecen durante la captura?---------------------

Durante la captura aparecieron cookies de sesión enviadas por el servidor:
Estas cookies identifican la sesión del usuario y permiten mantenerlo logueado en la web.

PHPSESSID
sessionid
cookies de autenticación del usuario


-------------------------¿Puedes reconstruir qué páginas visitó el usuario? Describe el flujo.-----------------------
Sí. Analizando las peticiones HTTP se puede reconstruir el recorrido del usuario:

Acceso a la página principal.
Entrada en la página de login.
Envío del formulario de inicio de sesión.
Acceso al panel principal tras autenticarse.
Navegación por distintas secciones internas.
El orden se puede ver siguiendo las peticiones GET y POST capturadas.

-------------------------¿Has encontrado algún error HTTP (404, 500…)? ¿En qué rutas?----------------------------------

404 Not Found al intentar acceder a rutas o recursos inexistentes (imágenes o páginas no disponibles)

---------------------Explica qué riesgos de seguridad existen al usar HTTP en lugar de HTTPS.----------------------

Usar HTTP es inseguro porque los datos viajan sin cifrar. Esto permite que cualquier persona que
intercepte la conexión pueda ver información sensible como usuarios, contraseñas o cookies de 
sesión. Un atacante podría robar la sesión del usuario o suplantar su identidad. HTTPS evita 
este problema cifrando la comunicación y protegiendo los datos enviados.
