---------Caso Práctico DS1: Análisis de Tráfico Web y Login con Wireshark (2)----------------

En esta actividad se ha realizado un análisis del tráfico web utilizando 
la herramienta Wireshark con el objetivo de observar cómo se comunican un 
navegador y un servidor cuando se navega por una página web sin cifrado.
A lo largo de la práctica se han capturado y analizado diferentes
peticiones HTTP, incluyendo el envío de formularios de login, 
parámetros GET y POST, así como cookies de sesión. El propósito principal 
ha sido comprender cómo viaja la información por la red y conocer los 
riesgos de seguridad que existen cuando se utilizan conexiones HTTP en lugar de HTTPS.

En la barra de filtros buscamos http y miramos las peticiones que salen

Para analizar un login buscamos por el filtro POST: http.request.method == "POST"

----------------------------------------4.3. Preguntas para entregar---------------------------------
---------------¿El login viaja en claro o cifrado?---------

El login viaja cifrado

----------Si viaja cifrado, ¿qué aparece en su lugar?------------------------

Cuando una conexión está cifrada (osea por HTTPS), los datos aparecen como información
ilegible y no se pueden ver en Wireshark.

-------------------Si viaja en claro, copiáis:----------------------
usuario
contraseña
parámetros adicionales

Viaja en cifrado


Para buscar cookies de sesión filtramis con http.set_cookie


------------------Preguntas para entregar------------------------
----------------¿La cookie tiene flags Secure, HttpOnly, SameSite? -------------------

la cookie no tiene el flag Secure ya que la conexión se realiza mediante HTTP. 
Tampoco veo protección con HttpOnly o SameSite

---------------¿Se envía en la misma petición del login? ---------------------

Sí, la cookie aparece después de realizar el login. El servidor 
la envía como respuesta tras iniciar sesión correctamente para identificar al usuario.

---------------------¿Se reutiliza durante toda la sesión? ---------------------

La cookie se reutiliza en las siguientes peticiones mientras la sesión permanece activa lo que 
permite que el usuario no tenga que volver a iniciar sesión en cada página.

--------------¿Podríais robarla si el tráfico no fuese HTTPS?-------------------

Sí, al usar HTTP la cookie viaja sin cifrar y podría ser interceptada con
herramientas como Wireshark. Un atacante podría usarla para suplantar la sesión del 
usuario sin necesidad de conocer la contraseña.

Para detectar patrones de ataques usamos el filtro  http.response.code >= 400


------------------------------Preguntas-----------------------------------
-------------------¿Qué tipo de errores aparecen más?--------------------

Los errores que aparecen con más frecuencia son los 404 que indican 
que el cliente intentó acceder a páginas o recursos que no existen en el servidor.


-------------------¿Alguna IP destaca como “sospechosa”?-------------

Sí que se observa una IP que realiza muchas peticiones seguidas
en poco tiempo. Esto puede indicar intentos automáticos de búsqueda
de vulnerabilidades.

---------¿Puedes reconstruir qué intentaba hacer ese cliente?-----------------
(por ejemplo: intentar acceder a /admin/ o /backup/)

Ni idea

-------------------Hallazgos importantes-------------------------
-------------------¿Se ven credenciales?-----------------

Sí, las credenciales del login se podían ver porque la web no cifraba la información enviada.

-------------¿Se identifican cookies inseguras?--------------------

Hay cookies de sesión vulnerables

---------------¿Qué tecnologías se filtran?-----------------

En las cabeceras HTTP se mostraba información del servidor y de 
la tecnología utilizada, como el tipo de servidor web y el uso de PHP.

-----------¿Alguna ruta interesante/extraña?---------------

Ni idea 
